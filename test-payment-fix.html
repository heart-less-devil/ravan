<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payment Test - Card Compatibility</title>
    <script src="https://js.stripe.com/v3/"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .card-info {
            background: #e8f4fd;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .test-card {
            border: 1px solid #ddd;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            background: #f9f9f9;
        }
        .success { color: green; }
        .error { color: red; }
        .warning { color: orange; }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #0056b3; }
        button:disabled { background: #ccc; cursor: not-allowed; }
        #card-element {
            border: 1px solid #ddd;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .error-message {
            color: red;
            margin: 10px 0;
            padding: 10px;
            background: #ffe6e6;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîß Payment System Test</h1>
        <p>This tool helps test different card types and identify payment issues.</p>
        
        <div class="card-info">
            <h3>üìã Test Cards for Different Scenarios</h3>
            <div class="test-card">
                <strong>‚úÖ Success Test Card:</strong><br>
                <code>4242 4242 4242 4242</code> - Visa (Always succeeds)
            </div>
            <div class="test-card">
                <strong>‚ùå Declined Test Card:</strong><br>
                <code>4000 0000 0000 0002</code> - Visa (Always declined)
            </div>
            <div class="test-card">
                <strong>üîê 3D Secure Test Card:</strong><br>
                <code>4000 0025 0000 3155</code> - Visa (Requires 3D Secure)
            </div>
            <div class="test-card">
                <strong>‚ö†Ô∏è Insufficient Funds:</strong><br>
                <code>4000 0000 0000 9995</code> - Visa (Insufficient funds)
            </div>
            <div class="test-card">
                <strong>üí≥ Indian Test Cards:</strong><br>
                <code>5555 5555 5555 4444</code> - Mastercard<br>
                <code>3782 822463 10005</code> - American Express
            </div>
        </div>

        <div id="payment-form">
            <h3>üí≥ Test Payment</h3>
            <div id="card-element">
                <!-- Stripe Elements will create form elements here -->
            </div>
            <div id="card-errors" role="alert"></div>
            <button id="submit-payment" disabled>Test Payment ($1.00)</button>
            <button id="clear-form">Clear Form</button>
        </div>

        <div id="results">
            <h3>üìä Test Results</h3>
            <div id="test-log"></div>
        </div>
    </div>

    <script>
        // Initialize Stripe
        const stripe = Stripe('pk_live_YOUR_STRIPE_PUBLISHABLE_KEY_HERE'); // Replace with your actual key
        const elements = stripe.elements();

        // Create card element
        const cardElement = elements.create('card', {
            style: {
                base: {
                    fontSize: '16px',
                    color: '#424770',
                    '::placeholder': {
                        color: '#aab7c4',
                    },
                },
                invalid: {
                    color: '#9e2146',
                },
            },
        });

        cardElement.mount('#card-element');

        // Handle real-time validation errors from the card Element
        cardElement.on('change', function(event) {
            const displayError = document.getElementById('card-errors');
            if (event.error) {
                displayError.textContent = event.error.message;
                document.getElementById('submit-payment').disabled = true;
            } else {
                displayError.textContent = '';
                document.getElementById('submit-payment').disabled = false;
            }
        });

        // Handle form submission
        document.getElementById('submit-payment').addEventListener('click', async function(ev) {
            ev.preventDefault();
            
            const submitButton = document.getElementById('submit-payment');
            const logDiv = document.getElementById('test-log');
            
            submitButton.disabled = true;
            submitButton.textContent = 'Processing...';
            
            logDiv.innerHTML += '<div class="warning">üîÑ Testing payment with current card details...</div>';

            try {
                // Create payment method
                const { error: pmError, paymentMethod } = await stripe.createPaymentMethod({
                    type: 'card',
                    card: cardElement,
                    billing_details: {
                        name: 'Test User',
                        email: 'test@example.com',
                    }
                });

                if (pmError) {
                    logDiv.innerHTML += `<div class="error">‚ùå Payment Method Error: ${pmError.message}</div>`;
                    logDiv.innerHTML += `<div class="error">Error Type: ${pmError.type}</div>`;
                    logDiv.innerHTML += `<div class="error">Error Code: ${pmError.code || 'N/A'}</div>`;
                } else {
                    logDiv.innerHTML += `<div class="success">‚úÖ Payment Method Created: ${paymentMethod.id}</div>`;
                    logDiv.innerHTML += `<div class="success">Card Type: ${paymentMethod.card.brand.toUpperCase()}</div>`;
                    logDiv.innerHTML += `<div class="success">Last 4: ****${paymentMethod.card.last4}</div>`;
                }

            } catch (error) {
                logDiv.innerHTML += `<div class="error">‚ùå Unexpected Error: ${error.message}</div>`;
            }

            submitButton.disabled = false;
            submitButton.textContent = 'Test Payment ($1.00)';
        });

        // Clear form
        document.getElementById('clear-form').addEventListener('click', function() {
            cardElement.clear();
            document.getElementById('card-errors').textContent = '';
            document.getElementById('test-log').innerHTML = '';
            document.getElementById('submit-payment').disabled = true;
        });

        // Add some initial instructions
        document.getElementById('test-log').innerHTML = `
            <div class="warning">
                <strong>Instructions:</strong><br>
                1. Use any of the test cards above<br>
                2. Fill in any future expiry date (e.g., 12/25)<br>
                3. Use any 3-digit CVC (e.g., 123)<br>
                4. Click "Test Payment" to see what happens
            </div>
        `;
    </script>
</body>
</html>
